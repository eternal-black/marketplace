-- MySQL Script generated by MySQL Workbench
-- 05/21/18 19:28:12
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema MARKETPLACE
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema MARKETPLACE
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `MARKETPLACE` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
USE `MARKETPLACE` ;

-- -----------------------------------------------------
-- Table `MARKETPLACE`.`CONTACT`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MARKETPLACE`.`CONTACT` ;

CREATE TABLE IF NOT EXISTS `MARKETPLACE`.`CONTACT` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `EMAIL` VARCHAR(45) NOT NULL,
  `PHONE` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `MARKETPLACE`.`ROLE`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MARKETPLACE`.`ROLE` ;

CREATE TABLE IF NOT EXISTS `MARKETPLACE`.`ROLE` (
  `ID` INT NOT NULL,
  `ROLE` VARCHAR(45) NULL,
  PRIMARY KEY (`ID`))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `MARKETPLACE`.`USER`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MARKETPLACE`.`USER` ;

CREATE TABLE IF NOT EXISTS `MARKETPLACE`.`USER` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `ID_CONTACT` INT NOT NULL,
  `RATING` INT NOT NULL,
  `LOGIN` VARCHAR(45) NOT NULL,
  `PASSWORD` VARCHAR(45) NOT NULL,
  `FIRSTNAME` VARCHAR(45) NOT NULL,
  `LASTNAME` VARCHAR(45) NOT NULL,
  `PHOTO` VARCHAR(45) NOT NULL,
  `ID_ROLE` INT NOT NULL,
  PRIMARY KEY (`ID`, `ID_ROLE`),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC),
  INDEX `fk_USER_CONTACT1_idx` (`ID_CONTACT` ASC),
  INDEX `FK_ROLE_idx` (`ID_ROLE` ASC),
  CONSTRAINT `FK_USER_CONTACT1`
  FOREIGN KEY (`ID_CONTACT`)
  REFERENCES `MARKETPLACE`.`CONTACT` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_ROLE`
  FOREIGN KEY (`ID_ROLE`)
  REFERENCES `MARKETPLACE`.`ROLE` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `MARKETPLACE`.`COUNTRY`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MARKETPLACE`.`COUNTRY` ;

CREATE TABLE IF NOT EXISTS `MARKETPLACE`.`COUNTRY` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `COUNTRY` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `MARKETPLACE`.`CITY`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MARKETPLACE`.`CITY` ;

CREATE TABLE IF NOT EXISTS `MARKETPLACE`.`CITY` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `CITY` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `id_UNIQUE` (`ID` ASC))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `MARKETPLACE`.`STREET`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MARKETPLACE`.`STREET` ;

CREATE TABLE IF NOT EXISTS `MARKETPLACE`.`STREET` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `STREET` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `MARKETPLACE`.`ADDRESS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MARKETPLACE`.`ADDRESS` ;

CREATE TABLE IF NOT EXISTS `MARKETPLACE`.`ADDRESS` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `ID_COUNTRY` INT NOT NULL,
  `ID_CITY` INT NOT NULL,
  `ID_STREET` INT NOT NULL,
  `HOUSE` VARCHAR(45) NOT NULL,
  `APARTMENT` VARCHAR(45) NULL,
  `POST_INDEX` INT NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC),
  INDEX `FK_COUNTRY_idx` (`ID_COUNTRY` ASC),
  INDEX `FK_CITY_idx` (`ID_CITY` ASC),
  INDEX `FK_STREET_idx` (`ID_STREET` ASC),
  CONSTRAINT `FK_COUNTRY`
  FOREIGN KEY (`ID_COUNTRY`)
  REFERENCES `MARKETPLACE`.`COUNTRY` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_CITY`
  FOREIGN KEY (`ID_CITY`)
  REFERENCES `MARKETPLACE`.`CITY` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_STREET`
  FOREIGN KEY (`ID_STREET`)
  REFERENCES `MARKETPLACE`.`STREET` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `MARKETPLACE`.`CATEGORY`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MARKETPLACE`.`CATEGORY` ;

CREATE TABLE IF NOT EXISTS `MARKETPLACE`.`CATEGORY` (
  `ID` INT NOT NULL,
  `CATEGORY` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ID`))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `MARKETPLACE`.`PRODUCT`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MARKETPLACE`.`PRODUCT` ;

CREATE TABLE IF NOT EXISTS `MARKETPLACE`.`PRODUCT` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `PRODEUCT_NAME` VARCHAR(45) NOT NULL,
  `PRICE` DOUBLE NOT NULL,
  `COUNT` INT NOT NULL,
  `ID_CATEGORY` INT NULL,
  `ID_USER_SELLER` INT NOT NULL,
  `DESCRIBE` VARCHAR(255) NULL,
  `DISCOUNT` INT NOT NULL,
  `MANUFACTURER` VARCHAR(45) NOT NULL,
  `EXIST` TINYINT(1) NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC),
  INDEX `FK_ACCOUNT_idx` (`ID_USER_SELLER` ASC),
  INDEX `FK_CATEGORY_idx` (`ID_CATEGORY` ASC),
  CONSTRAINT `FK_ACCOUNT`
  FOREIGN KEY (`ID_USER_SELLER`)
  REFERENCES `MARKETPLACE`.`USER` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_CATEGORY`
  FOREIGN KEY (`ID_CATEGORY`)
  REFERENCES `MARKETPLACE`.`CATEGORY` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `MARKETPLACE`.`ORDER`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MARKETPLACE`.`ORDER` ;

CREATE TABLE IF NOT EXISTS `MARKETPLACE`.`ORDER` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `ID_PRODUCT` INT NOT NULL,
  `COST` DOUBLE NOT NULL,
  `COUNT` INT NOT NULL,
  `ID_USER_BUYER` INT NOT NULL,
  `STATUS` TINYINT(1) NOT NULL,
  `ORDER_DATA` DATE NOT NULL,
  `ID_ADDRESS` INT NULL,
  `DATE OF COMPLETION` DATE NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC),
  INDEX `FK_PRODUCT_idx` (`ID_PRODUCT` ASC),
  INDEX `FK_BUYER_idx` (`ID_USER_BUYER` ASC),
  INDEX `FK_ADDRESS_idx` (`ID_ADDRESS` ASC),
  CONSTRAINT `FK_PRODUCT`
  FOREIGN KEY (`ID_PRODUCT`)
  REFERENCES `MARKETPLACE`.`PRODUCT` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_BUYER`
  FOREIGN KEY (`ID_USER_BUYER`)
  REFERENCES `MARKETPLACE`.`USER` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_ADDRESS`
  FOREIGN KEY (`ID_ADDRESS`)
  REFERENCES `MARKETPLACE`.`ADDRESS` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `MARKETPLACE`.`WALLET`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MARKETPLACE`.`WALLET` ;

CREATE TABLE IF NOT EXISTS `MARKETPLACE`.`WALLET` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `ID_USER` INT NOT NULL,
  `VALUE` VARCHAR(45) NOT NULL,
  `CURRENCY` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC),
  INDEX `ID_USER_idx` (`ID_USER` ASC),
  CONSTRAINT `FK_USER_CASH`
  FOREIGN KEY (`ID_USER`)
  REFERENCES `MARKETPLACE`.`USER` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `MARKETPLACE`.`FEEDBACK`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `MARKETPLACE`.`FEEDBACK` ;

CREATE TABLE IF NOT EXISTS `MARKETPLACE`.`FEEDBACK` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `ID_USER_COMMENTATOR` INT NOT NULL,
  `ID_PRODUCT` INT NOT NULL,
  `COMMENT` VARCHAR(255) NOT NULL,
  `COMMENT_DATA` DATE NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC),
  INDEX `FK_COMMENTATOR_idx` (`ID_USER_COMMENTATOR` ASC),
  INDEX `FK_PRODUCT_idx` (`ID_PRODUCT` ASC),
  CONSTRAINT `FK_COMMENTATOR`
  FOREIGN KEY (`ID_USER_COMMENTATOR`)
  REFERENCES `MARKETPLACE`.`USER` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_PRODUCT`
  FOREIGN KEY (`ID_PRODUCT`)
  REFERENCES `MARKETPLACE`.`PRODUCT` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
